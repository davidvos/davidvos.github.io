<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">

  {%- include head.html -%}

  <body>

    {%- include header.html -%}

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {{ content }}
      </div>
    </main>

    {%- include footer.html -%}

    <script>
      (function() {
        var storageKey = 'preferred-theme';
        var darkClass = 'theme-dark';
        var toggle = document.getElementById('theme-toggle');
        var textNode = toggle ? toggle.querySelector('.theme-toggle__text') : null;

        function applyTheme(theme) {
          var isDark = theme === 'dark';
          document.body.classList.toggle(darkClass, isDark);
          if (toggle) {
            toggle.setAttribute('aria-pressed', isDark ? 'true' : 'false');
            toggle.setAttribute('aria-label', isDark ? 'Switch to light mode' : 'Switch to dark mode');
          }
          if (textNode) {
            textNode.textContent = isDark ? 'Switch to light mode' : 'Switch to dark mode';
          }
        }

        function getPreferredTheme() {
          var stored = null;
          try {
            stored = localStorage.getItem(storageKey);
          } catch (err) {}
          if (stored === 'dark' || stored === 'light') return stored;
          return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        var current = getPreferredTheme();
        applyTheme(current);

        if (toggle) {
          toggle.addEventListener('click', function() {
            current = document.body.classList.contains(darkClass) ? 'light' : 'dark';
            applyTheme(current);
            try {
              localStorage.setItem(storageKey, current);
            } catch (err) {}
          });
        }
      })();
    </script>

  </body>

</html>
